<!DOCTYPE html>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/ClientSide/html.html to edit this template
-->
<html>
    <head>
        <title>K2 Security team members</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel ="stylesheet" href="../css/style.css">
        <link rel="stylesheet" href="../css/bootstrap.min.css">
    </head>
    <body id="ManagerUsers">
        <nav class="navbar navbar-expand-lg bg-body-tertiary">
            <div class="container-fluid">
                <a class="navbar-brand" id="navbarlabel">K2 Security</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                    <div class="navbar-nav">
                        <a class="nav-link active" aria-current="page" href="ManagerHome.html">Home</a>
                        <a class="nav-link" href="#">User Profiles</a>
                        <a class="nav-link" href="#">Generate Reports</a>
                        <a class="nav-link" href="ManagerSchedule.html">Employee Schedules</a>
                        <a class="nav-link" href="#">Time off requests</a>
                        <a class="nav-link me-0 ms-auto btn btn-secondary rounded-pill" href="#" id="logoutlink">Log out</a>
                    </div>
                </div>
            </div>
        </nav>
        <!-- End of Navbar code -->
        <div class="container" style="padding: 20px">
            <button id="addButton" class="btn btn-primary">Add User</button>
            <table class="table">
                <thead class="table-primary">
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">First</th>
                        <th scope="col">Last</th>
                        <th scope="col">Phone</th>
                        <th scope="col">Email</th>
                        <th scope="col">Role</th>
                        <th scope="col">Edit Details</th>
                        <th scope="col">Delete User</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="table-light">
                        <th scope="row">1</th>
                        <td>Shafi</td>
                        <td>Miah</td>
                        <td>07484162790</td>
                        <td>miahs44@lsbu.ac.uk</td>
                        <td>Employee</td>
                        <td><button type="button" class="btn btn-success">Edit</button></td>
                        <td><button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#DeleteModal" data-employee-id="1">Delete</button></td>
                    </tr>
                    <tr class="table-light">
                        <th scope="row">2</th>
                        <td>Adem</td>
                        <td>Tarhan</td>
                        <td>0738651922</td>
                        <td>tarhana@lsbu.ac.uk</td>
                        <td>Employee</td>
                        <td> <button type="button" class="btn btn-success">Edit</button></td>
                        <td><button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#DeleteModal" data-employee-id="2">Delete</button></td>
                    </tr>
                    <tr class="table-light">
                        <th scope="row">3</th>
                        <td>Jahid</td>
                        <td>Shikder</td>
                        <td>0798361257</td>
                        <td>shikderj@lsbu.ac.uk</td>
                        <td>Employee</td>
                        <td><button type="button" class="btn btn-success">Edit</button></td>
                        <td><button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#DeleteModal" data-employee-id="3">Delete</button></td>
                    </tr>
                    <tr class="table-light">
                        <th scope="row">4</th>
                        <td>Muhammad</td>
                        <td>Shayaan</td>
                        <td>0763581265</td>
                        <td>mehboom3@lsbu.ac.uk</td>
                        <td>Employee</td>
                        <td><button type="button" class="btn btn-success">Edit</button></td>
                        <td><button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#DeleteModal" data-employee-id="4">Delete</button></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="modal fade" id="DeleteModal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="exampleModalLabel">Deleting User</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p><strong> Are you sure you would like to delete this Employee? This action is permanent and cannot be undone.</strong>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-danger" id="deleteButton">I understand</button>
                    </div>
                </div>
            </div>
        </div>
        <script>
            const deleteButton = document.getElementById("deleteButton");
            deleteButton.addEventListener("click", () => {
                
                const employeeId = deleteButton.getAttribute("data-employee-id");
                fetch(`/employees/${employeeId}`, {
                    method: 'DELETE'
                })
                        .then(response => {
                            if (response.ok) {
                                console.log('Employee record deleted.');
                            } else {
                                console.error('Error deleting employee record.');
                            }
                        })
                        .catch(error => {
                            console.error('Network error:', error);
                        });
            });
            const addButton = document.getElementById("addButton");
            addButton.addEventListener("click", () => {
                // Get the table body
                const tableBody = document.querySelector("tbody");

                // Create a new row
                const newRow = tableBody.insertRow(-1);

                // Add cells to the row with the user details
                const cell1 = newRow.insertCell(0);
                const cell2 = newRow.insertCell(1);
                const cell3 = newRow.insertCell(2);
                const cell4 = newRow.insertCell(3);
                const cell5 = newRow.insertCell(4);
                const cell6 = newRow.insertCell(5);
                const cell7 = newRow.insertCell(6);
                const cell8 = newRow.insertCell(7);

                cell1.innerHTML = tableBody.rows.length - 1;
                cell2.innerHTML = "John";
                cell3.innerHTML = "Doe";
                cell4.innerHTML = "1234567890";
                cell5.innerHTML = "newuser@example.com";
                cell6.innerHTML = "Employee";
                cell7.innerHTML = '<button type="button" class="btn btn-success">Edit</button>';
                cell8.innerHTML = '<button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#DeleteModal" data-employee-id="5">Delete</button>';
            });
        </script>
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>
    </body>
</html>
